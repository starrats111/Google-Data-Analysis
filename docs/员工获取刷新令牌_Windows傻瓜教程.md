# 员工获取刷新令牌 - Windows CMD 超简单教程

## 📋 准备工作

你需要准备：
- ✅ 经理提供的**客户端ID**和**客户端密钥**
- ✅ 你的**Google账号**（需要访问Google Ads的账号）

---

## 🚀 三步完成（复制粘贴即可）

### 第1步：打开CMD（命令提示符）

**方法A：**
1. 按 `Win键 + R`
2. 输入 `cmd`
3. 按 `Enter`

**方法B：**
1. 点击开始菜单
2. 输入 `cmd`
3. 点击"命令提示符"

---

### 第2步：进入项目目录

在CMD中，**一条一条**复制粘贴以下命令：

```cmd
cd /d D:\Google Analysis\backend
```

**如果项目不在D盘，请修改路径：**
- 如果在C盘：`cd /d C:\Google Analysis\backend`
- 如果在E盘：`cd /d E:\Google Analysis\backend`

---

### 第3步：设置环境变量并运行脚本

**一条一条**复制粘贴以下命令（**替换为你自己的客户端ID和密钥**）：

```cmd
set GOOGLE_ADS_SHARED_CLIENT_ID=经理提供的客户端ID
```

```cmd
set GOOGLE_ADS_SHARED_CLIENT_SECRET=经理提供的客户端密钥
```

```cmd
python scripts\get_google_ads_refresh_token.py
```

---

## 📝 详细步骤（带截图说明）

### 步骤1：打开CMD

1. 按键盘上的 `Win键`（Windows图标键）+ `R键`
2. 会弹出"运行"窗口
3. 输入 `cmd`
4. 按 `Enter` 或点击"确定"

**你会看到：**
```
C:\Users\你的用户名>
```

---

### 步骤2：进入项目目录

在CMD中输入（**根据你的实际路径修改**）：

```cmd
cd /d D:\Google Analysis\backend
```

**按 `Enter`**

**你会看到：**
```
D:\Google Analysis\backend>
```

**如果提示"系统找不到指定的路径"：**
- 检查项目是否在D盘
- 检查路径是否正确
- 可以先用 `dir` 命令查看当前目录的文件

---

### 步骤3：设置客户端ID

复制粘贴以下命令（**如果经理给了不同的客户端ID，替换掉**）：

```cmd
set GOOGLE_ADS_SHARED_CLIENT_ID=经理提供的客户端ID
```

**按 `Enter`**

**不会显示任何内容，这是正常的！**

---

### 步骤4：设置客户端密钥

复制粘贴以下命令（**如果经理给了不同的客户端密钥，替换掉**）：

```cmd
set GOOGLE_ADS_SHARED_CLIENT_SECRET=经理提供的客户端密钥
```

**按 `Enter`**

**不会显示任何内容，这是正常的！**

---

### 步骤5：运行脚本

复制粘贴以下命令：

```cmd
python scripts\get_google_ads_refresh_token.py
```

**按 `Enter`**

---

### 步骤6：完成授权

1. **浏览器会自动打开**（如果没有，复制显示的网址到浏览器）
2. **选择你的Google账号**（需要访问Google Ads的账号）
3. **点击"允许"或"继续"**
4. **如果提示"应用未验证"**：
   - 点击"高级"
   - 点击"继续前往 xxx（不安全）"
5. **授权成功后，浏览器会显示"授权成功"**

---

### 步骤7：复制刷新令牌

回到CMD窗口，你会看到类似这样的输出：

```
刷新令牌 (Refresh Token):
你的刷新令牌（从脚本输出中复制）
```

**复制整个刷新令牌**（从 `1//` 开始到结尾的所有内容）

---

## ✅ 完成！

现在你有了：
- ✅ **刷新令牌**（Refresh Token）

下一步：在系统中添加MCC账号时，只需要：
1. MCC账号ID
2. 这个刷新令牌

---

## ❓ 常见问题

### Q1: 提示"python不是内部或外部命令"

**解决方法：**
1. 检查是否安装了Python
2. 如果没有安装，联系经理安装Python
3. 或者使用 `py` 命令代替 `python`：
   ```cmd
   py scripts\get_google_ads_refresh_token.py
   ```

### Q2: 提示"系统找不到指定的路径"

**解决方法：**
1. 确认项目路径是否正确
2. 可以先输入 `dir` 查看当前目录
3. 如果项目在桌面，路径可能是：`C:\Users\你的用户名\Desktop\Google Analysis\backend`

### Q3: 浏览器没有自动打开

**解决方法：**
1. CMD中会显示一个网址，类似：`http://localhost:8080/...`
2. 复制这个网址
3. 粘贴到浏览器中打开

### Q4: 授权时提示"应用未验证"

**解决方法：**
1. 这是正常的（因为应用还在测试阶段）
2. 点击"高级"
3. 点击"继续前往 xxx（不安全）"
4. 继续授权

### Q5: 授权后没有显示刷新令牌

**解决方法：**
1. 检查CMD窗口是否有错误信息
2. 确认浏览器是否显示"授权成功"
3. 如果还是不行，联系经理

### Q6: 环境变量设置后，运行脚本还是提示需要输入

**解决方法：**
1. 确认环境变量设置正确（没有多余空格）
2. 确认在同一CMD窗口中运行脚本
3. 如果还是不行，可以手动修改脚本文件（联系经理）

---

## 📞 需要帮助？

如果遇到问题：
1. 截图错误信息
2. 联系经理
3. 或者查看详细指南：`docs/员工配置MCC账号指南.md`

