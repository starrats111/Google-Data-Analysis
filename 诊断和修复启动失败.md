# 诊断和修复启动失败

## 步骤1：查看详细错误日志

```bash
tail -n 100 ~/Google-Data-Analysis/backend/run.log
```

## 步骤2：检查是否有进程在运行

```bash
ps aux | grep uvicorn | grep -v grep
```

如果有进程，先停止：
```bash
pkill -9 -f "uvicorn app.main:app"
sleep 2
```

## 步骤3：手动测试导入

```bash
cd ~/Google-Data-Analysis/backend
source venv/bin/activate
python -c "from app.services.rewardoo_service import RewardooService; print('导入成功')"
```

如果导入失败，会显示具体错误。

## 步骤4：检查Python语法

```bash
cd ~/Google-Data-Analysis/backend
source venv/bin/activate
python -m py_compile app/services/rewardoo_service.py
python -m py_compile app/services/platform_data_sync.py
```

## 步骤5：重新启动（确保环境正确）

```bash
cd ~/Google-Data-Analysis/backend
source venv/bin/activate
python -c "import app.main; print('主模块导入成功')"
```

如果成功，再启动服务：
```bash
nohup uvicorn app.main:app --host 0.0.0.0 --port 8000 > run.log 2>&1 &
sleep 3
curl -s http://127.0.0.1:8000/health && echo "✓ 启动成功" || tail -n 50 run.log
```

## 常见错误及解决方案

### 错误1：ModuleNotFoundError
- 检查是否在虚拟环境中
- 运行：`pip install -r requirements.txt`

### 错误2：SyntaxError
- 检查Python版本：`python --version`（需要3.7+）
- 检查代码语法

### 错误3：ImportError
- 检查导入路径是否正确
- 检查依赖是否安装

### 错误4：端口被占用
```bash
lsof -i :8000
kill -9 <PID>
```

